<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Code Quiz - Home</title>
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Bungee+Shade&family=Lexend:wght@100..900&display=swap');
		body {
			background-color: #5bc0eb;
		}
		.navbar-custom {
			background-color: #404E4D;
		}
		.navbar-custom .navbar-brand {
			color: #FDE74C;
			font-family: 'Bungee Shade', cursive;
			font-size: 2.2rem;
		}
		.navbar-custom .nav-link {
			color: #FDE74C;
			font-family: 'Lexend', sans-serif;
		}
		.btn-warning {
			font-family: 'Lexend', sans-serif;
		}
		.body-text, .lead {
			font-family: 'Lexend', sans-serif;
		}
		.footer-custom {
			background-color: #404E4D;
			color: #FDE74C;
			font-family: 'Lexend', sans-serif;
			padding: 0.5rem 0;
			text-align: center;
			position: fixed;
			left: 0;
			bottom: 0;
			width: 100%;
			font-size: 0.875rem;
		}
		
		/* Custom navbar layout for perfect centering */
		.navbar-brand-container {
			flex: 0 0 auto;
			min-width: 150px;
		}
		
		.navbar-center {
			flex: 1 1 auto;
			position: relative;
		}
		
		.navbar-nav-container {
			flex: 0 0 auto;
			min-width: 150px;
		}
		
		/* Responsive adjustments */
		@media (max-width: 991px) {
			.navbar-center {
				order: 3;
				flex-basis: 100%;
				margin-top: 10px;
			}
		}
		
		/* Two-column layout responsive adjustments */
		@media (max-width: 768px) {
			.row {
				flex-direction: column;
			}
			.col-lg-4.col-md-5 {
				margin-top: 30px;
			}
		}
	</style>
</head>
<body>
	<!-- Navbar -->
	<nav class="navbar navbar-expand-lg navbar-custom">
		<div class="container-fluid d-flex justify-content-between align-items-center">
			<!-- Left: Brand -->
			<div class="navbar-brand-container">
				<a class="navbar-brand" href="#">Code Quiz</a>
			</div>
			
			<!-- Center: User Status Display -->
			<div class="navbar-center d-flex justify-content-center flex-grow-1">
				{% if user.is_authenticated %}
					<span style="color: #FDE74C; font-family: 'Lexend', sans-serif; font-size: 1.1rem;">
						You are signed in as <strong>{{ user.username }}</strong>
					</span>
				{% endif %}
			</div>
			
			<!-- Right: Navigation and Toggler -->
			<div class="navbar-nav-container d-flex align-items-center">
				<button class="navbar-toggler me-3" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link" href="#">HTML</a>
						</li>
						<li class="nav-item d-flex align-items-center" style="height:100%;">
							<span class="vr mx-2" style="background-color:#FDE74C; width:2px; height:1.5em; align-self:center;"></span>
							<a class="nav-link" href="#">CSS</a>
						</li>
						<li class="nav-item d-flex align-items-center" style="height:100%;">
							<span class="vr mx-2" style="background-color:#FDE74C; width:2px; height:1.5em; align-self:center;"></span>
							<a class="nav-link" href="#">JavaScript</a>
						</li>
						<li class="nav-item d-flex align-items-center" style="height:100%;">
							<span class="vr mx-2" style="background-color:#FDE74C; width:2px; height:1.5em; align-self:center;"></span>
							<a class="nav-link" href="#">Python</a>
						</li>
						{% if user.is_authenticated %}
						<li class="nav-item d-flex align-items-center" style="height:100%;">
							<span class="vr mx-2" style="background-color:#FDE74C; width:2px; height:1.5em; align-self:center;"></span>
							<a class="nav-link" href="{% url 'logout' %}">Logout</a>
						</li>
						{% endif %}
					</ul>
				</div>
			</div>
		</div>
				</ul>
			</div>
		</div>
	</nav>

	<!-- Main Content -->
	<div class="container mt-5">
		<div class="row">
			<!-- Left Column: Main Content -->
			<div class="col-lg-8 col-md-7 text-center">
				<h1 class="display-4" style="color:#404E4D; font-family: 'Bungee Shade', cursive;">Welcome to  the Code Quiz!</h1>
				<p class="lead body-text" style="color:#404E4D; font-family: 'Lexend', sans-serif; margin-top: 2rem;">Test your coding knowledge with fun and challenging quizzes.</p>
				<!-- Animated Mascot: Bouncing Cat -->
				<div class="d-flex justify-content-center my-4">
					<svg width="200" height="240" viewBox="0 0 200 240" fill="none" xmlns="http://www.w3.org/2000/svg" style="animation: bounce 1.2s infinite;">
						<!-- Cat body -->
						<ellipse cx="100" cy="140" rx="60" ry="70" fill="#FDE74C" stroke="#404E4D" stroke-width="8"/>
						
						<!-- Cat head -->
						<ellipse cx="100" cy="80" rx="40" ry="36" fill="#FDE74C" stroke="#404E4D" stroke-width="8"/>
						<!-- Cat ears -->
						<polygon points="70,60 80,20 90,60" fill="#FDE74C" stroke="#404E4D" stroke-width="6"/>
						<polygon points="130,60 120,20 110,60" fill="#FDE74C" stroke="#404E4D" stroke-width="6"/>
						<!-- Cat inner ears -->
						<polygon points="78,44 80,28 86,56" fill="#FFB6B6" stroke="#FFB6B6" stroke-width="2"/>
						<polygon points="122,44 120,28 114,56" fill="#FFB6B6" stroke="#FFB6B6" stroke-width="2"/>
						<!-- Cat eyes -->
						<ellipse id="cat-eye-left" cx="88" cy="80" rx="6" ry="8" fill="#404E4D"/>
						<ellipse id="cat-eye-right" cx="112" cy="80" rx="6" ry="8" fill="#404E4D"/>
						<!-- Cat eyelids for blinking -->
						<ellipse id="cat-eyelid-left" cx="88" cy="80" rx="6" ry="8" fill="#FDE74C" style="opacity:0;"/>
						<ellipse id="cat-eyelid-right" cx="112" cy="80" rx="6" ry="8" fill="#FDE74C" style="opacity:0;"/>
						<!-- Cat nose -->
						<ellipse cx="100" cy="94" rx="4" ry="3" fill="#404E4D"/>
						<!-- Cat mouth -->
						<path d="M96 100 Q100 108 104 100" stroke="#404E4D" stroke-width="4" fill="none"/>
						<!-- Cat whiskers -->
						<path d="M84 94 Q68 96 84 100" stroke="#404E4D" stroke-width="2" fill="none"/>
						<path d="M116 94 Q132 96 116 100" stroke="#404E4D" stroke-width="2" fill="none"/>
						<path d="M84 100 Q68 104 84 108" stroke="#404E4D" stroke-width="2" fill="none"/>
						<path d="M116 100 Q132 104 116 108" stroke="#404E4D" stroke-width="2" fill="none"/>
						<!-- Cat arms (moved up and bigger) -->
						<path d="M64 120 Q40 144 80 176 Q88 184 104 176" stroke="#404E4D" stroke-width="10" fill="none"/>
						<ellipse cx="80" cy="176" rx="8" ry="5" fill="#FDE74C" stroke="#404E4D" stroke-width="3"/>
						<path d="M136 120 Q160 144 120 176 Q112 184 96 176" stroke="#404E4D" stroke-width="10" fill="none"/>
						<ellipse cx="120" cy="176" rx="8" ry="5" fill="#FDE74C" stroke="#404E4D" stroke-width="3"/>
						<!-- Cat paws -->
						<ellipse cx="56" cy="210" rx="12" ry="8" fill="#FDE74C" stroke="#404E4D" stroke-width="3"/>
						<ellipse cx="144" cy="210" rx="12" ry="8" fill="#FDE74C" stroke="#404E4D" stroke-width="3"/>
						<!-- Cat tail -->
						<path d="M160 180 Q190 220 160 240" stroke="#404E4D" stroke-width="8" fill="none"/>
					</svg>
				</div>
								<style>
										@keyframes bounce {
												0%, 100% { transform: translateY(0); }
												50% { transform: translateY(-20px); }
										}
								</style>
								<script>
								// Animate cat eyes to blink every 2.5 seconds
								setInterval(() => {
									document.getElementById('cat-eyelid-left').style.opacity = '1';
									document.getElementById('cat-eyelid-right').style.opacity = '1';
									setTimeout(() => {
										document.getElementById('cat-eyelid-left').style.opacity = '0';
										document.getElementById('cat-eyelid-right').style.opacity = '0';
									}, 200);
								}, 2000);
								</script>
				<a href="#" class="btn btn-warning btn-lg mt-3 me-2" style="background-color:#FDE74C; color:#404E4D; border:none;">HTML</a>
				<a href="#" class="btn btn-warning btn-lg mt-3 me-2" style="background-color:#FDE74C; color:#404E4D; border:none;">CSS</a>
				<a href="#" class="btn btn-warning btn-lg mt-3 me-2" style="background-color:#FDE74C; color:#404E4D; border:none;">JavaScript</a>
				<a href="#" class="btn btn-warning btn-lg mt-3" style="background-color:#FDE74C; color:#404E4D; border:none;">Python</a>
			</div>
			
			<!-- Right Column: Auth Section -->
			<div class="col-lg-4 col-md-5 d-flex align-items-center justify-content-center">
				<!-- Auth buttons - Only show if user is not authenticated -->
				{% if not user.is_authenticated %}
				<div class="w-100" style="border: 2px solid #404E4D; padding: 15px; border-radius: 10px; background-color: rgba(253, 231, 76, 0.1); max-width: 300px;">
					<h5 style="color:#404E4D; font-family: 'Lexend', sans-serif; margin-bottom: 15px; text-align: center;">Join the Quiz Community!</h5>
					<div class="d-grid gap-2">
						<button type="button" class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#loginModal" style="padding: 10px 20px; font-size: 16px;">
							üîë Login
						</button>
						<button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#registerModal" style="padding: 10px 20px; font-size: 16px;">
							üìù Register
						</button>
					</div>
				</div>
				{% else %}
				<!-- Welcome message for authenticated users -->
				<div class="w-100" style="border: 2px solid #404E4D; padding: 15px; border-radius: 10px; background-color: rgba(253, 231, 76, 0.2); max-width: 300px;">
					<h5 style="color:#404E4D; font-family: 'Lexend', sans-serif; margin-bottom: 10px; text-align: center;">Welcome back!</h5>
					<p style="color:#404E4D; font-family: 'Lexend', sans-serif; margin-bottom: 15px; text-align: center; font-size: 14px;"><strong>{{ user.username }}</strong> üéâ</p>
					<p style="color:#404E4D; font-family: 'Lexend', sans-serif; margin-bottom: 15px; text-align: center; font-size: 14px;">Ready to test your coding skills?</p>
					<div class="d-grid">
						<a href="{% url 'logout' %}" class="btn btn-outline-secondary btn-lg" style="padding: 10px 20px; font-size: 16px; border-color: #404E4D; color: #404E4D;">
							üö™ Logout
						</a>
					</div>
				</div>
				{% endif %}
			</div>
		</div>
	</div>

	<!-- Login Modal -->
	<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header" style="background-color:#404E4D;">
					<h5 class="modal-title" id="loginModalLabel" style="color:#FDE74C; font-family: 'Lexend', sans-serif;">Login</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
				</div>
				<div class="modal-body" style="background-color:#5bc0eb;">
					<form id="loginForm">
						<div class="mb-3">
							<label for="loginUsername" class="form-label" style="color:#404E4D; font-family: 'Lexend', sans-serif;">Username</label>
							<input type="text" class="form-control" id="loginUsername" required>
						</div>
						<div class="mb-3">
							<label for="loginPassword" class="form-label" style="color:#404E4D; font-family: 'Lexend', sans-serif;">Password</label>
							<input type="password" class="form-control" id="loginPassword" required>
						</div>
						<div id="loginMessage" class="alert" style="display:none;"></div>
					</form>
				</div>
				<div class="modal-footer" style="background-color:#5bc0eb;">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-success" id="loginSubmit">Login</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Register Modal -->
	<div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header" style="background-color:#404E4D;">
					<h5 class="modal-title" id="registerModalLabel" style="color:#FDE74C; font-family: 'Lexend', sans-serif;">Create Account</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: invert(1);"></button>
				</div>
				<div class="modal-body" style="background-color:#5bc0eb;">
					<form id="registerForm">
						<div class="mb-3">
							<label for="registerUsername" class="form-label" style="color:#404E4D; font-family: 'Lexend', sans-serif;">Username</label>
							<input type="text" class="form-control" id="registerUsername" required>
						</div>
						<div class="mb-3">
							<label for="registerPassword" class="form-label" style="color:#404E4D; font-family: 'Lexend', sans-serif;">Password</label>
							<input type="password" class="form-control" id="registerPassword" required>
						</div>
						<div class="mb-3">
							<label for="confirmPassword" class="form-label" style="color:#404E4D; font-family: 'Lexend', sans-serif;">Confirm Password</label>
							<input type="password" class="form-control" id="confirmPassword" required>
						</div>
						<div id="registerMessage" class="alert" style="display:none;"></div>
					</form>
				</div>
				<div class="modal-footer" style="background-color:#5bc0eb;">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary" id="registerSubmit">Create</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Footer -->
	<footer class="footer-custom">
		<div class="container">
			<span>&copy; 2025 Code Quiz. All rights reserved.</span>
		</div>
	</footer>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
	
	<!-- Custom JavaScript for Auth -->
	<script>
		// Get CSRF token
		function getCSRFToken() {
			return document.querySelector('[name=csrfmiddlewaretoken]')?.value || '';
		}

		// Login functionality
		document.getElementById('loginSubmit').addEventListener('click', function() {
			const username = document.getElementById('loginUsername').value;
			const password = document.getElementById('loginPassword').value;
			const messageDiv = document.getElementById('loginMessage');

			if (!username || !password) {
				showMessage(messageDiv, 'Please fill in all fields.', 'danger');
				return;
			}

			fetch('/login/', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
					'X-CSRFToken': getCookie('csrftoken')
				},
				body: JSON.stringify({
					username: username,
					password: password
				})
			})
			.then(response => response.json())
			.then(data => {
				if (data.success) {
					showMessage(messageDiv, data.message, 'success');
					setTimeout(() => {
						location.reload(); // Reload page to show logged in state
					}, 1500);
				} else {
					showMessage(messageDiv, data.message, 'danger');
				}
			})
			.catch(error => {
				showMessage(messageDiv, 'An error occurred. Please try again.', 'danger');
			});
		});

		// Register functionality
		document.getElementById('registerSubmit').addEventListener('click', function() {
			const username = document.getElementById('registerUsername').value;
			const password = document.getElementById('registerPassword').value;
			const confirmPassword = document.getElementById('confirmPassword').value;
			const messageDiv = document.getElementById('registerMessage');

			if (!username || !password || !confirmPassword) {
				showMessage(messageDiv, 'Please fill in all fields.', 'danger');
				return;
			}

			if (password !== confirmPassword) {
				showMessage(messageDiv, 'Passwords do not match.', 'danger');
				return;
			}

			fetch('/register/', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
					'X-CSRFToken': getCookie('csrftoken')
				},
				body: JSON.stringify({
					username: username,
					password: password
				})
			})
			.then(response => response.json())
			.then(data => {
				if (data.success) {
					showMessage(messageDiv, data.message, 'success');
					setTimeout(() => {
						bootstrap.Modal.getInstance(document.getElementById('registerModal')).hide();
						bootstrap.Modal.getOrCreateInstance(document.getElementById('loginModal')).show();
					}, 1500);
				} else {
					showMessage(messageDiv, data.message, 'danger');
				}
			})
			.catch(error => {
				showMessage(messageDiv, 'An error occurred. Please try again.', 'danger');
			});
		});

		// Helper function to show messages
		function showMessage(element, message, type) {
			element.className = `alert alert-${type}`;
			element.textContent = message;
			element.style.display = 'block';
		}

		// Helper function to get cookie
		function getCookie(name) {
			let cookieValue = null;
			if (document.cookie && document.cookie !== '') {
				const cookies = document.cookie.split(';');
				for (let i = 0; i < cookies.length; i++) {
					const cookie = cookies[i].trim();
					if (cookie.substring(0, name.length + 1) === (name + '=')) {
						cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
						break;
					}
				}
			}
			return cookieValue;
		}
	</script>
</body>
</html>
